<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>ads-github-tools by salewski</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>ads-github-tools</h1>
        <p>Manage a large number of GitHub repos (command line tools)</p>

        <p class="view"><a href="https://github.com/salewski/ads-github-tools">View the Project on GitHub <small>salewski/ads-github-tools</small></a></p>

        <ul>
          <li class="li-tarball-link"><span id="lbl-latest-tarball"><strong>Latest (released <code>2022-10-16</code>):</strong></span><br><a href="downloads/ads-github-tools-0.3.4.tar.gz"><code>ads-github-tools-0.3.4.tar.gz</code></a></li>
        </ul>

        <ul>
<!--
          <li><a href="https://github.com/salewski/ads-github-tools/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/salewski/ads-github-tools/tarball/master">Download <strong>TAR Ball</strong></a></li>
-->

          <li class="li-downloads-archive-link"><a href="downloads/"><strong>Downloads Archive</strong></a></li>

<!--
          <li><a href="https://github.com/salewski/ads-github-tools">View On <strong>GitHub</strong></a></li>
-->
        </ul>

      </header>
      <section>
        <h3>
<a id="welcome-to-ads-github-tools" class="anchor" href="#welcome-to-ads-github-tools" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>'<code>ads-github-pages</code>' project home page</h3>

<p>The <code>ads-github-tools</code> project provides command line tools for managing a
large number of GitHub repositories, motivated by the following two related
use cases:
<ol type="1">

  <li><p>When you work on multiple computers, keeping your local clones of the
         repos in synch can be a chore.</p>
  </li>
       
  <li><p>Similarly, when you have a large number of GitHub repos that are mostly
         forks of other repos, keeping your forks in synch with the upstream
         changes can be a chore.</p>
  </li>
</ol>

Enter the <code>ads-github-tools</code>.
</p>

<h2>Usage</h2>
<p>
Typical usage involves ensuring there is an updated cache, and then just
invoking a couple of commands.
</p>

<p>
The cache is updated like this:
</p>
<pre>
    $ <strong>ads-github-cache -v --update</strong>
</pre>
<p>
First time users will want to update the cache prior to running any of the
other commands. It may take a while to poplute the cache the first time
(especially if you have a large number of GitHub repos), but updating it
thereafer is done conditionally and on an as-needed basis. Note that the only
objects cached are those used by the various utilities in the
<code>ads-github-tools</code>; it does not cache any data that is not used.
</p>

<p>
The cache is provided in order to avoid unnecessary network round trips to the
GitHub API servers and allow the utilities to work quickly in an interactive
shell process. The cache storage is specific to each GitHub user. A Unix
system user may have multiple GitHub accounts (say, work and personal); the
cached data for those GitHub users would be stored separately.
</p>

<p>
Regular users would probably just run the above cache update command (say,
once or twice a day) from a cron job (or similar). That way the cached data is
already available when you need it.
</p>

<p>
With the cached data in hand, you're ready to run the other utilities. Typical
invocation involves only one or two commands, both invoked from the parent
directory of the user's directory that contains his GitHub projects (forked
and otherwise). The <tt>'ads-github-tools'</tt> author typcially runs these
two commands once or twice daily:
</p>
<pre>
    $ ads-github-fetch-all-upstreams -v -c

    $ ads-github-merge-all-upstreams -v -k -p
</pre>
</p>

<p>
Many users would prefer to run those commands from a crontab (or similar); the
author runs them manually because he is actively hacking on the tools and wants
to inspect the output.
</p>

<p>The following invocation is also handy for creating local clones of recently
forked GitHub repos:</p>
<pre>
    $ ads-github-fetch-all-upstreams -m
</pre>
<p>
That will clone all of a user's GitHub repos for which there is no working
directory beneath the current directory. It can be thought of as creating
clones of "all the new stuff (and <em>just</em> the new stuff)"; it operates much
more quickly than invocations that operate on all of a user's GitHub repos
(assuming only a minority of them are "missing", which is the common
case). Note that the <tt>'-m'</tt> (<tt>--missing-only</tt>) option was introduced in the
version of <tt>'ads-github-fetch-all-upstreams'</tt> released with
<tt>ads-github-tools-0.2.0</tt> (circa 2017).
</p>


<h2>Installation</h2>
<p>
Installation should be as simple as:
<pre>
    $ ./configure   # add a --prefix=path/to/some/location to install someplace other than beneath /usr/local
    $ make
    $ make check    # optional, but encouraged
    $ make install
</pre>
</p>


<h2>Progams provided by <tt>ads-github-tools</tt></h2>
<p>
At the time of writing (<tt>2022-10-16</tt>) there are ten tools:
<ul>

  <li><p><strong><tt>ads-github-cache</tt></strong> - Manipulate
      the <tt>ads-github-tools</tt> cache. Mainly used to keep relevant GitHub
      data at-the-ready for use by the other utilities, but will also be of
      interest to software developers working with the GitHub v3 API. Because
      the tool can hide the paging necessary to obtain all of the items for a
      given resource, the following is a very fast way to get all of data for
      all of the user's repo:</p><pre>
    $ <strong>ads-github-cache --get-cached '/user/repos' | jq '.'</strong>
</pre></li>

  <li><p><strong><tt>ads-github-whoami</tt></strong> - Show the currently authenticated GitHub user. This
      program similar in spirit to the Unix <strong><tt>whoami(1)</tt></strong> and <strong><tt>id(1)</tt></strong> commands, but
      shows information about the authenticated GitHub user (as understood by the
      GitHub API). Obtains its direct information via the GitHub v3 API call:</p>
      <pre>
    GET /user
</pre><p>
      Default output is plain text for interactive command line use, but we
      provide a knob to have the raw JSON response emitted, as well. The
      <strong><tt>ads-github-whoami</tt></strong> command was added
      in <strong><tt>ads-github-tools-0.3.1</tt></strong>.</p>
  </li>

  <li><p><strong><tt>ads-github-normalize-url</tt></strong> - Produces a
      "normalized" view of a given URL, suitable for use in generating an
      ID. Currently is a quick 'n dirty implementation optimized for this sole
      purpose, so there's no guarantee that the normalized variation of the URL
      will actually work</p>
  </li>

  <li><p><strong><tt>ads-github-hash-url</tt></strong> - Similar in spirit to
      <tt>git-hash-object(1)</tt>, this tool takes a (presumably normalized) URL
      and emits a checksum for it. Currently uses the SHA-3 256-bit algorithm
      variant.</p>
  </li>
  
  <li><p><strong><tt>ads-github-show-rate-limits</tt></strong> - Show user's
      GitHub API rate limits ("core", "search", "graphql", others).</p>
  </li>

  <li><p><strong><tt>ads-github-fetch-all-upstreams</tt></strong> - Operates
      on the working directories of a collection of GitHub-hosted git
      repositories. The user can specify one or more repositories explicitly to
      restrict operations to just those repos. Each that is found with an
     'upstream' remote defined will have `git fetch upstream` invoked in it.</p>

     <ul>
  
         <li><p>With the <tt>'--clone-if-missing'</tt> option, any of the
             user's GitHub repos for which there is not a git working directory
             beneath the current location will be cloned (using the
             <tt>'git-hub'</tt> tool's <code>clone</code> operation, which sets up
             the 'upstream' remote if the repo is a fork).</p>
         </li>

         <li><p>There's also an <tt>'--upstream-remote-if-missing'</tt> option
             that will add the 'upstream' remote on existing project working
             directories that do not have it (only if the project is a fork of
             another project, of course).</p>
         </li>

         <li><p><tt>'ads-github-tools-0.2.0'</tt> (circa 2017) added the <tt>'--missing-only'</tt>
             option (which implies <tt>'--clone-if-missing'</tt>). The <tt>'--missing-only'</tt>
             option limits the program's activity to operating on <em>only</em> the
             user's "missing" GitHub repos. It can be thought of as creating clones
             of "all the new stuff (and <em>just</em> the new stuff)"; it operates
             much more quickly than invocations that operate on all of a user's
             GitHub repos (assuming only a minority of them are "missing", which
             tends to be the common case).</p>
         </li>
     </ul>
    
  <li><p><strong><tt>ads-github-merge-all-upstreams</tt></strong> - Operates
         on the working directories of a collection of GitHub-hosted git
         repositories. Each that is found with both 'origin' and 'upstream' remotes
         defined will have:
<pre>
    $ git merge --ff-only  upstream/&lt;DEFAULT_BRANCH_NAME&gt;
</pre>
         invoked in it. The user can specify one or more repositories
         explicitly to restrict operations to just those repos. The program is
         careful to sanity check the local repository before attempting any
         operations on it. Also, it will skip any repository for which the git
         index has any changes recorded. Will (temporarily) check out the
         default branch before merging (if the working directory happens to
         have some other branch checked out, or if it happens to be on a detached
         HEAD); will restore the originally checked out branch (or detached HEAD)
         when done if the temporary switch was necessary.</p>

      <ul>
          <li><p>With one <tt>'--push'</tt> option, will invoke
              <code>'git push origin &lt;DEFAULT_BRANCH_NAME&gt;'</code>

              for each repo that has changes merged into it during the program
              invocation.</p>
          </li>

          <li><p>With two <tt>'--push'</tt> options, will invoke

               <code>'git push origin &lt;DEFAULT_BRANCH_NAME&gt;'</code>

               for each repo that is not being skipped over for some other
               reason (e.g. local changes in the working directory),
               regardless of whether changes are merged into it during the
               program invocation. This is useful for pushing changes that
               were merged but not pushed during earlier runs of the program
               invoked without the <tt>'--push'</tt> option.
               </p>
          </li>
      </ul>
  </li>
  <li><p><strong><tt>ads-github-repo-create</tt></strong> - Creates a new
      GitHub repo with a given name and attributes (description, default
      branch, etc.). Newly created repo is empty by default (suitable for
      importing existing Git repos into GitHub), but can optionally be
      auto-initialized (more suitable for projects being started from
      scratch). The <strong><tt>ads-github-repo-create</tt></strong> command
      was added in
      <strong><tt>ads-github-tools-0.3.1</tt></strong>.</p>
  </li>
  <li><p><strong><tt>`ads-github-nproc</tt></strong>` - Prints on stdout the
      number of CPUs available to the current process. It provides a common
      interface to the rest of the <tt>`ads-github-tools</tt>` programs that may
      need that data. To accomplish its task, however, the program will
      attempt to use a number of platform specific techniques. The code for
      this program is adapted from the <tt>`AX_COUNT_CPUS</tt>` macro from the
      GNU Autoconf Archive. See <strong><tt>`ads-github-nproc(1)</tt></strong>`
      and the comments in the code for original authorship of the macro, as
      well a licensing that is inherited from the original m4 macro source
      file (though still GPL compatible).</p>
  </li>
  <li><p><strong><tt>parse-netrc</tt></strong> - Parses the user's <tt>'~/.netrc'</tt> file to obtain the first
      matching record by host machine name (and optionally by user login
      name). This is used by <tt>ads-github-cache</tt> to determine the name of the
      in-effect GitHub user account, using the approach that emulates what
      <tt><a href="https://curl.haxx.se/docs/manpage.html"
             title="manpage: curl(1)">curl(1)</a></tt> does. This allows for
      entirely offline cache operations against the user-specific cache. The
      tool name does not start with the <tt>'ads-github-'</tt> prefix because
      it is being considered for extraction into a small stand-alone project.
  </li>
</ul>


<h2>Future directions</h2>

<p>
The <strong><tt>ads-github-tools-0.3.2</tt></strong> release <strong>(October
2020)</strong> introduced the foundations for the long-wanted caching
system. It delivers on the ability to conditionally retrieve objects "through
the cache" using <strong><tt>'ETag:'</tt></strong> and
<strong><tt>'If-None-Match:'</tt></strong> to pull full objects over the
network only when necessary. It also delivers on the goal of being easy to use
from shell scripts or even in an interactive shell.
</p>

<p>
Note that conditionally fetching objects as described also has the benefit of
avoiding incurring unnecessary hits against the user's GitHub API rate
limit. (<em>Not sure where you stand?
Try <strong><tt>'ads-github-show-rate-limits -h'</tt></strong> to find
out!</em>)
</p>

<p>
At the moment, the caching foundation is in place, and the
<tt>ads-github-fetch-all-upstreams</tt> tool uses it to good effect. But
currently it is the <em>only</em> tool that does so. Others will be enhanced,
as well, in upcoming releases.
</p>

<p>
My earlier thinking was that there will be three levels of tools:
<ol type="1">
  <li><p>low-level tools that store and retrieve objects from the cache, and related
    <ul>
      <li><tt>'ads-github-cache update'</tt> (similar in spirit to
          <tt>'apt-get update'</tt> and <tt>'apt-file update'</tt>)
      </li>

      <li><tt>'ads-github-cache put KEY [VALUE]'</tt></li>
      <li><tt>'ads-github-cache get KEY'</tt></li>
      <li><tt>'ads-github-normalize-url'</tt>></li>
      <li><tt>'ads-github-hash-url'</tt></li>
    </ul>
    </p>

    <p>In the above list, <tt>'KEY'</tt> is likey a "normalized" url, or
       perhaps just <em>any</em> url (and the tools would normalize the url
       behind the scenes to produce the "key").</p>
  </li>

  <li><p>mid-level tools that make use of the caching tools
    <ul>
      <li><tt>'ads-github-user-repos [--owner] [--repo] [--per-page=N] [--page=N]'</tt></li>
      <li><tt>'ads-github-org-repos [--org] [--repo]...'</tt></li>
      <li><tt>'ads-github-repos [--list-tags] [--list-branches] ...'</tt></li>
      <li><tt>'...'</tt></li>
    </ul>
    </p>
  </li>

  <li><p>high-level tools the build upon the first two levels above
    <ul>
      <li><tt>'ads-github-show-rate-limits'</tt></li>
      <li><tt>'ads-github-fetch-all-upstreams'</tt></li>
      <li><tt>'ads-github-merge-all-upstreams'</tt></li>
      <li><tt>'...'</tt></li>
    </ul>
    </p>
  </li>
</ol>
That does not seem like a terrible arrangement, but we have learned that there
is value in allowing the high-level tools access the low-level cache directly.
</p>

<br></br>

<h2><tt>ads-github-tools</tt> license</h2>
<p>
<pre>
GPLv2+: GNU GPL version 2 or later &lt;http://gnu.org/licenses/gpl.html&gt;
</pre>
</p>

<p>
Unless otherwise stated by a different license notice in a particular file,
all files in the `ads-github-tools' project are made available under the GNU
GPL version 2, or (at your option) any later version.
</p>

<p>
See the <a href="https://github.com/salewski/ads-github-tools/blob/master/COPYING">COPYING</a> file for the full license.
</p>

<p>
<pre>
Copyright (C) 2016, 2017, 2019, 2020, 2021, 2022 Alan D. Salewski &lt;ads@salewski.email&gt;

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License along
    with this program; if not, write to the Free Software Foundation, Inc.,
    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
</pre>
</p>


<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>The <code>ads-github-tools</code> project code was written by <a href="https://github.com/salewski" class="user-mention">Alan D. Salewski</a>.</p>

<p>The <a href="https://github.com/">GitHub</a> project page is located at:
<ul>
    <li><a href="https://github.com/salewski/ads-github-tools">https://github.com/salewski/ads-github-tools</a></li>
</ul>
</p>





<!-- FIXME: add note and link to 'BUGS' file here -->

      </section>

      <footer>
        <h3><a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>
        <p>This project page is maintained (barely!) by <a href="https://github.com/salewski">Alan D. Salewski</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
